- hosts: samba_server
  vars_prompt:
  - name: smb_username
    prompt: username
    private: no
  - name: smb_password
    prompt: password
    private: yes
    confirm: yes
  tasks:
  - name: install samba
    apt:
      name: samba
      state: present
  - name: render samba config
    template:
      src: files/smb.conf
      dest: /etc/samba/smb.conf
  - name: create samba user
    command: 'smbpasswd -a {{ smb_username }} -w "{{ smb_password }}"'
    no_log: yes
  - name: restart samba server
    systemd:
      name: smbd
      state: restarted
