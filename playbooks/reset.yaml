- hosts: cluster
  roles:
  - name: k3s/reset
    when: k8s_provisioner == 'k3s'
  - name: k8s/reset
    when: k8s_provisioner == 'kubeadm'

- hosts: etcd
  roles:
  - etcd/reset

- hosts: localhost
  tasks:
  - include_role:
      name: "{{ infrastructure_provisioner | default('terraform') }}/destroy"
  - include_role:
      name: "{{ infrastructure_provisioner | default('terraform') }}/up"

- hosts: all
  roles:
  - wait-for-server