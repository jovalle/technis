- hosts: control_plane
  become: yes
  pre_tasks:
    - name: assert variables
      assert:
        that:
          keepalived_vip is defined
    - name: gather facts for all hosts
      setup:
      delegate_to: "{{ item }}"
      delegate_facts: yes
      with_items: "{{ groups['all'] }}"
  roles:
  - keepalived
  - haproxy