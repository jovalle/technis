- name: get files
  shell: curl -L --remote-name-all https://github.com/cilium/cilium-cli/releases/latest/download/cilium-linux-{{ 'arm64' if (ansible_architecture | regex_search('arm|aarch')) else 'amd64' }}.tar.gz{,.sha256sum}

- name: checksum
  command: sha256sum --check cilium-linux-{{ 'arm64' if (ansible_architecture | regex_search('arm|aarch')) else 'amd64' }}.tar.gz.sha256sum

- name: unarchive tarball
  shell: tar xzvfC cilium-linux-{{ 'arm64' if (ansible_architecture | regex_search('arm|aarch')) else 'amd64' }}.tar.gz /usr/local/bin

- name: remove artifacts
  shell: rm cilium-linux-{{ 'arm64' if (ansible_architecture | regex_search('arm|aarch')) else 'amd64' }}.tar.gz{,.sha256sum}