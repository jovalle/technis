- name: setup storage providers
  include_tasks: provider.yaml
  vars:
    storage_provider: "{{ item }}"
  when:
    - inventory_hostname == groups['control_plane'][0]
    - storage_providers is defined
    - storage_providers is iterable
  with_items:
    - "{{ storage_providers }}"